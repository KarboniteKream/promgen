{% extends "base.html" %}
{% load promgen %}
{% block content %}

{% breadcrumb label="Alerts" %}

<form class="navbar-form navbar-left" action="/alert">
    <div class="form-group">
        <input name="search" type="text" value="{{ search }}" class="form-control" placeholder="Service, Project">
        <button type="submit" class="btn btn-default">Search</button>
    </div>
</form>

<table class="table">
    <tr>
        <th>Created</th>
        <th>Alertname</th>
        <th>Datasource</th>
        <th>Service</th>
        <th>Project</th>
        <th>Job</th>
        <th>Sent</th>
        <th>Error</th>
    </tr>
    {% for alert in alert_list %}
    <tr>
        <td><a href="{{alert.get_absolute_url}}">{{alert.created}}</a></td>
        <td>{{alert.json.commonLabels.alertname}}</td>
        <td>{{alert.json.commonLabels.datasource}}</td>
        <td>{{alert.json.commonLabels.service}}</td>
        <td>{{alert.json.commonLabels.project}}</td>
        <td>{{alert.json.commonLabels.job}}</td>
        <td {% if alert.sent_count == 0 %}class="warning" {% endif %}>{{alert.sent_count}}</td>
        <td {% if alert.error_count %}class="danger" {% endif %}>{{alert.error_count}}</td>
    </tr>
    {% endfor %}
</table>

<nav aria-label="Page navigation">
    {% if page_obj.has_other_pages %}
    <ul class="pagination">
        {% if page_obj.has_previous %}
        <li><a href="?page={{ page_obj.previous_page_number }}&search={{ search }}">&laquo;</a></li>
        {% else %}
        <li class="disabled"><span>&laquo;</span></li>
        {% endif %}

        <li class="active">
            <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }} <span class="sr-only">(current)</span></span>
        </li>

        {% if page_obj.has_next %}
        <li><a href="?page={{ page_obj.next_page_number }}&search={{ search }}">&raquo;</a></li>
        {% else %}
        <li class="disabled"><span>&raquo;</span></li>
        {% endif %}
    </ul>
    {% endif %}
</nav>

{% endblock %}
